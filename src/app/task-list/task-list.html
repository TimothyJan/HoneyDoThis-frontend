<!-- Add task Form -->
<div id="form">
    <form (ngSubmit)="addTask($event)">
        <input
            class="task-input"
            type="text"
            placeholder="Add a task."
            [(ngModel)]="newTaskText"
            name="todoInput"
            [ngClass]="currentTheme + '-input'">
        <button
            class="task-btn"
            type="submit"
            [ngClass]="currentTheme + '-button'">
            Add
        </button>
    </form>
</div>

<!-- Filter Buttons -->
<div class="filter-container">
    <button
        class="filter-btn"
        [ngClass]="[
            currentTheme + '-button',
            currentFilter === 'all' ? 'active-filter' : ''
        ]"
        (click)="setFilter('all')">
        View All ({{ totalCount }})
    </button>
    <button
        class="filter-btn"
        [ngClass]="[
            currentTheme + '-button',
            currentFilter === 'active' ? 'active-filter' : ''
        ]"
        (click)="setFilter('active')">
        Active ({{ activeCount }})
    </button>
    <button
        class="filter-btn"
        [ngClass]="[
            currentTheme + '-button',
            currentFilter === 'completed' ? 'active-filter' : ''
        ]"
        (click)="setFilter('completed')">
        Completed ({{ completedCount }})
    </button>
</div>

<!-- Clear Completed Button (optional) -->
@if (hasCompletedTasks) {
    <div class="clear-container">
        <button
            class="clear-btn"
            [ngClass]="currentTheme + '-button'"
            (click)="clearCompleted()">
            Clear Completed
        </button>
    </div>
}

<!-- Task List -->
<div id="myUnOrdList">
    <ul class="task-list">
        @for(task of filteredTasks; track task.id) {
            <li class="task"
                [ngClass]="[currentTheme + '-task', task.completed ? 'completed' : '']"
                [class.fall]="task.isFalling">
                <span class="task-item">{{ task.text }}</span>
                <button
                    class="check-btn"
                    [ngClass]="currentTheme + '-button'"
                    (click)="toggleComplete(task.id)">
                    <i class="fas fa-check"></i>
                </button>
                <button
                    class="delete-btn"
                    [ngClass]="currentTheme + '-button'"
                    (click)="deleteTask(task.id)">
                    <i class="fas fa-trash"></i>
                </button>
            </li>
        }

        <!-- Empty state message -->
        @if (filteredTasks.length === 0) {
            <li class="task empty-state"
                [ngClass]="currentTheme + '-task'">
                <span class="task-item">
                    @if (currentFilter === 'all') {
                        No tasks yet. Add one above!
                    } @else if (currentFilter === 'active') {
                        No active tasks. Great job!
                    } @else {
                        No completed tasks yet.
                    }
                </span>
            </li>
        }
    </ul>
</div>
